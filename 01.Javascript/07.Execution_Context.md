## 실행컨텍스트 (Execution Context)

- 실행 가능한 코드(일반적으로는 전역 코드와 함수 코드)에 제공할 환경정보를 모아놓은 객체
- scope, hoisting, this, function, closure 등과 같은 js의 동적 언어로서의 동작원리를 담고 있는 JS 핵심 원리

### 실행 컨텍스트의 역할

1. 전체 코드의 환경과 순서를 보장
    - 동일한 환경에 있는 코드를 실행할 때 필요한 환경 정보를 모아 객체 구성
    - call stack에 쌓아올림
    - 가장 위에 쌓여있는 컨텍스트와 관련있는 코드를 실행

    > call stack ??   
    > Javascript 엔진이 원시타입 값과 함수 호출의 실행 컨텍스트를 저장하는 곳(요청이 동기적으로 처리)

2. 실행 컨텍스트가 활성화되는 시점에 선언된 변수를 **호이스팅**
3. 외부 환경 정보 구성
4. this 값 설정

> 실행 컨텍스트는 Javascript의 **동적 언어**로서의 성격을 가장 잘 파악할 수 있는 개념


### 실행 컨텍스트 구성

---

*🖍️ 실행 컨텍스트가 생성되는 경우*
- *전역 공간은 자동으로 컨텍스트로 구성*
- *(일반적인) 함수 실행*
- *`eval()` 함수 실행*
- *블록 생성 *

---

실행 컨텍스트를 구성할 때 아래와 같은 것들이 생성

1. **Variable Environment**
    - 현재 컨텍스트 내 식별자들에 대한 정보 + 외부 환경 정보
    - 선언 시점의 Lexical Environment 스냅샷 (변경 사항 반영 X)

2. **Lexical Environment**
    - (최초) VariableEnvironment 복사 > 변경사항이 실시간으로 반영
    - **environmentRecord**
        - 현재 컨텍스트와 관련된 코드의 식별자 정보(매개변수 식별자, 함수 자체, 함수 내부 식별자) 저장
        - 호이스팅 발생

    - **outerEnvironmentReference**
        - 현재 호출된 함수가 선언될 당시의 LexicalEnvironment를 참조
        - 스코프, 스코프 체인 형성

3. **ThisBinding**
    - this 식별자가 바라봐야 할 대상 객체


### 전역 컨텍스트와 함수 컨텍스트

![실행컨텍스트](../99.image/executioncontext.png)

1. `전역 컨텍스트` 먼저 실행
2. `함수 실행 컨텍스트` 함수 호출 시마다 컨텍스트 발생
3. 컨텍스트 생성 시, 컨텍스트 안에 변수 객체Variable object, scope chain, this 생성
4. 컨텍스트 생성 후 함수 실행
5. 함수 실행이 마무리되면 해당 컨텍스트는 사라짐 (클로저 제외)
6. 페이지가 종료되면 전역 컨텍스트가 사라짐